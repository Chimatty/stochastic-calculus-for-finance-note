# 無裁定価格評価モデル

## 二項モデル

二項モデルは離散的な時間軸のもとで考える。つまり、現在、次の時点、次の次の時点という点列が時間そのものであると考える。

現実では、株価は現在時点で決定しており、次の時点でいくらになるかは確率的に決まる。つまり次の時点以降では株価は確率変数である。この確率変数を、コイン投げの結果に依存して2値のいずれかに定まるものと仮定するのが二項モデルである。

二項モデルを扱う目的の一つは、株価変動を二項モデルでシミュレーションすることによって、株式から生み出した派生証券の現在価格を合理的に見積もることである。

### 一期間二項モデル

二項モデルを現在(=**時刻0**)と次の時点(=**時刻1**)でのみ考えたものを**一期間二項モデル**という。

#### コイン投げ事象

一つのコインがあり、コインの表が出る確率が$$p$$、裏が出る確率が$$q = 1 - p$$であるとする。

#### 株式マーケットの定義

$$S$$という株式があるとする。

株式$$S$$の価格は

- 時刻0では$$S_0$$
- 時刻1では、コイン投げの結果に依存し、表が出れば$$S_1(H)$$、裏が出れば$$S_1(T)$$

とする。$$S_1(H)$$または$$S_1(T)$$のいずれかになる確率変数として表したいときは単に$$S_1$$と表す。

また、便宜のため

- **上昇率** $$u := S_1(H)/S_0$$ 
- **下落率** $$d := S_1(T)/S_0$$

と定義しておく。

#### マネーマーケットの定義

株式$$S$$とは別に、コイン投げに依存しないで価格が決まるマーケットとして**マネーマーケット**というものを考える。（一般には国債のようなデフォルトリスクがないものをイメージすれば良い。）

- **金利**$$r$$が存在し、時刻0におけるマネーマーケットの1ドルは、時刻1において$$1+r$$ドルになるとする。

#### 無裁定条件の仮定

- **無裁定条件** $$0 < d < 1 + r < u$$

を仮定する。(無裁定条件、および裁定機会について詳しくは書籍を参照)

#### リスク中立確率

もし、コイン投げの確率が$$p,q$$ではなく、

$$
\tilde{p} = \frac{1 + r - d}{u - d}
$$
$$
\tilde{q} = \frac{u - (1 + r)}{u - d}
$$

であるとすると、$$S_1$$の期待値が$$(1+r)S_0$$となることが計算することで分かる。この確率(値)を**リスク中立確率**という。定義により、リスク中立確率である場合、この投資によるリターンの期待値はマネーマーケットでの運用と等しいので、リスクを取るメリットがない。

#### ポートフォリオと複製

各マーケットへの資産配分のことを**ポートフォリオ**という。（各マーケットの資産を並べたベクトルと思えば良い）

時刻0で異なるポートフォリオ$$A$$,$$B$$であっても、時刻1での資産合計がコイン投げの結果に依存せず等しくなる場合がある。このとき、$$B$$は$$A$$の**複製**であるという。

#### 派生証券の時刻0での無裁定価格

もし時刻0で、ある派生証券のみを持っているポートフォリオ$$A$$を、オプション以外のマーケットで構成したポートフォリオ$$B$$で複製できれば、$$B$$の資産総額はその派生証券の時刻0での**無裁定価格**と考えることができる。もしそうでなければ、裁定機会が生じていることになる。（証明略）

#### 派生証券の無裁定価格の導出

この派生証券が時刻1において

- コイン投げの結果が表ならば $$V_1(H)$$
- コイン投げの結果が裏ならば $$V_1(T)$$

となると仮定した時の時刻0での無裁定価格 $$V_0$$ を求める。

（ポートフォリオは、マネーマーケットの資産と株式$$S$$の資産を並べて表記する）

まずは複製ポートフォリオを構成する。無裁定価格は、このポートフォリオ構成するために必要な手持ち額と一致する必要がある。そこで、手持ちの額を $$V_0$$ とする。ここから、$$\Delta_0$$分の株式$$S$$を購入したポートフォリオ$$(V_0 - \Delta_0 S_0, \Delta_0 S_0)$$は、時刻1で$$((1+r)(V_0 - \Delta_0 S_0), \Delta_0 S_1)$$となる。このポートフォリオの資産総額が派生証券の時刻1での価格にコイン投げの結果にかかわらず一致すれば良いので、

$$
(1+r)(V_0 - \Delta_0 S_0) + \Delta_0 S_1(H) = V_1(H)
$$
$$
(1+r)(V_0 - \Delta_0 S_0) + \Delta_0 S_1(T) = V_1(T)
$$

を$$V_0$$と$$\Delta_0$$について解けばよい。これを解くと

$$
V_0 = \frac{1}{1 + r}(\tilde{p}V_1(H) + \tilde{q}V_1(T))
$$
$$
\Delta_0 = \frac{V_1(H) - V_1(T)}{S_1(H) - S_1(T)}
$$

が得られる。前者を**リスク中立価格評価式**、後者を**デルタ・ヘッジ式**という。

### 多期間二項モデル

一期間二項モデルの考え方を多期間に拡張する。

#### $$N$$期間二項モデル

**時刻0**から**時刻**$$N$$まで、同じコインを$$N$$回投げる事象を考える。これを$$N$$期間二項モデルという。

#### コイン投げ事象

$$n$$回のコイン投げの結果を $$\omega_1 \ldots \omega_n$$ と表記する。ただし、$$\omega_i \in \{H, T\}$$である。例えば、表、表、裏と出た場合は$$HHT$$と表記する。

#### 株価

時刻$$n$$での株価$$S_n$$は、それまでの全てのコイン投げの結果に依存する。コイン投げの結果が$$\omega_1 \ldots \omega_n$$であれば、株価は$$S_n(\omega_1 \ldots \omega_n)$$となる。

#### 派生証券の無裁定価格

派生証券の価格がコイン投げの結果に依存して時刻$$N$$において$$V_N(\omega_1 \ldots \omega_N)$$となるとする。このとき、一期間二項モデルと同様にして無裁定価格$$V_0$$を計算したい。

時刻$$n$$の時点で、コイン投げの結果が$$\Omega = \omega_1 \ldots \omega_n$$であると仮定し、次の時刻$$n+1$$における派生証券の価格がコイン投げの結果に依存して、表が出た場合は$$V_{n+1}(\Omega H)$$、裏が出た場合は$$V_{n+1}(\Omega T)$$となると仮定する。

時刻$$n$$におけるポートフォリオ

$$
(V_n(\Omega) - \Delta(\Omega) S_i(\Omega), \Delta(\Omega) S_i(\Omega))
$$

は時刻$$n+1$$において、

$$
((1+r)\{V_n(\Omega) - \Delta(\Omega) S_i(\Omega)\}, \Delta(\Omega) S_{i+1}(\Omega))
$$

となるので、

$$
(1+r)\{V_n(\Omega) - \Delta(\Omega) S_i(\Omega)\} + \Delta(\Omega) S_{i+1}(\Omega H) = V_{n+1}(\Omega H)
$$
$$
(1+r)\{V_n(\Omega) - \Delta(\Omega) S_i(\Omega)\} + \Delta(\Omega) S_{i+1}(\Omega T) = V_{n+1}(\Omega T)
$$

を解けば良い。これを解くと、

$$
V_n(\Omega) = \frac{1}{1 + r}(\tilde{p}V_{n+1}(\Omega H) + \tilde{q}V_{n+1}(\Omega T))
$$

$$
\Delta_n(\Omega) = \frac{V_{n+1}(\Omega H) - V_{n+1}(\Omega T)}{S_{n+1}(\Omega H) - S_{n+1}(\Omega T)}
$$

となる。$$V_N$$の価格は分かっているので、上式を使って$$V_{n-1}, V_{n-2}, V_{n-3} \ldots$$ と帰納的に定義することで$$V_0$$を計算することができる。
